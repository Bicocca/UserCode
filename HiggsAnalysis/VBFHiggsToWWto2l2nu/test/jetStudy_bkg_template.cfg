process plot = {
include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"
include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"
include "PhysicsTools/HepMCCandAlgos/data/genCandidates.cfi"
include "PhysicsTools/HepMCCandAlgos/data/genParticleCandidatesFast.cfi"
include "PhysicsTools/RecoCandAlgos/data/allTracks.cfi"
include "Configuration/EventContent/data/EventContent.cff"
include "HiggsAnalysis/VBFHiggsToWWto2l2nu/data/allEleIds.cfi"

include "DATASETFILE"

  service = TFileService 
    { 
       string fileName = "OUTPUT_ROOT"
    }

untracked PSet maxEvents = {untracked int32 input = -1}
untracked PSet options = { untracked bool wantSummary = true }

service = MessageLogger {}

module refEleIsolation = VBFElectronIsolationRef
{
  InputTag src = refResolver
  InputTag trackInputTag = ctfWithMaterialTracks
  double coneRadius = 0.3
  double vetoRadius = 0.02
  double otherVetoRadius = 0.015
  double ptMin = 1.5
  double lipMax = 100. //PG i.e. no selection by now
  double tkIsoCut = 0.3
  untracked bool useTkQuality = false
}

#module jetCleaner = VBFJetCleaning
#{
#InputTag src  = iterativeCone5CaloJets
#InputTag GSFInputTag = refResolver
#double maxDeltaR = 0.3
#double minEleOJetEratio = 0
#double maxHEoverEmE = 1000
#}

module jetCleaner = VBFJetCleaning
  {
    InputTag src = iterativeCone5CaloJets
    InputTag GSFInputTag = refEleIsolation
    double maxDeltaR = 0.5
    double maxHEoverEmE = 0.2
    double minEleOJetEratio = 0. //PG i.e. no cut
  }

module numJetFilter_afterClean = VBFJetNumFilter
{
    InputTag jetInputTag  = jetCleaner
    int32 maxJetNum = 100
    int32 minJetNum = 2
}

module jetUEPU = VBFJetEtaPtSelecting
{
    InputTag src  = jetCleaner
    double maxEta = 5
    double minPt = 15 # GeV
}

module numJetFilter_afterUEPU = VBFJetNumFilter
{
    InputTag jetInputTag  = jetUEPU
    int32 maxJetNum = 100
    int32 minJetNum = 2
}


module tagJets = VBFJetTagger
  {
    InputTag jetInputTag  = jetUEPU
    string tagJetsName = "tagJets"
    string otherJetsName = "otherJets"
    double jetEtaMax = 5
    double jetPtMin = 15 # GeV
    double gatherConeSize = 0.5
    int32 algoType = 1
  }


module jetStudy = VBFTagsMaxPt
{
    InputTag tagJetInputTag = tagJets:tagJets
    InputTag otherJetInputTag = tagJets:otherJets
    InputTag tracksInputTag = ctfWithMaterialTracks
}


module my_VBFMCProcessFilter = VBFMCProcessFilter
{
   untracked string moduleLabel = "source"
}

path reading = {refEleIsolation & jetCleaner & numJetFilter_afterClean & jetUEPU & numJetFilter_afterUEPU &  tagJets & jetStudy}

}
